<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blog</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notiflix@3.2.6/dist/notiflix-3.2.6.min.css"
      integrity="sha256-quZ4+TPWUyQzuPnahKf6d8Xal6tZcYZTzSt4wFVEFn8=" crossorigin="anonymous" />

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/icheck-bootstrap/3.0.1/icheck-bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/icheck-bootstrap/3.0.1/icheck-bootstrap.css">

<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
</head>

<body>
    <div id="loading">
<div style="margin:20px 20px 50px 0;max-width:450px">
<h3 style="text-align: center;">Blog</h3>

<label for="txtTitle">Title</label>
  <input type="text" class="form-control" id="txtTitle" />
  <label for="txtAuthor">Author</label>
  <input type="text" class="form-control" id="txtAuthor" />
  <label for="txtContent">Content</label>
  <input type="text" class="form-control" id="txtContent" />
  <div style="display: flex;justify-content: space-between;max-width: 300px">
  <div class="icheck-primary">
    <input type="checkbox" id="romance" value="Romance" name="txtGenre">
    <label for="romance">Romance</label>
    </div>
  
    <div class="icheck-primary">
    <input type="checkbox" id="travel" value="Travelling" name="txtGenre">
    <label for="travel">Travelling</label>
    </div>
  
    <div class="icheck-primary">
    <input type="checkbox" id="business" value="Business" name="txtGenre">
    <label for="business">Business</label>
    </div>
  </div>

  <div style="display: flex;justify-content: space-between;max-width: 250px">
  <div class="icheck-primary">
    <input type="radio" name="txtStatus" id="published" value="Published" checked>
    <label for="published">Published</label>
    </div>
  
    <div class="icheck-primary">
    <input type="radio" name="txtStatus" id="notPublished" value="Not Published">
    <label for="notPublished">Not Published</label>
  </div>
  </div>


  <button type="button" class="btn btn-success" id="btnSave">Save</button>
  <button type="button" class="btn btn-info" id="btnUpdate">Update</button>
</div>
</div>
</div>

  <table class="table">
    <thead>
      <tr>
        <th></th>
        <th scope="col">No.</th>
        <th scope="col">Title</th>
        <th scope="col">Author</th>
        <th scope="col">Content</th>
        <th scope="col">Genre</th>
        <th scope="col">Status</th>
      </tr>
    </thead>
    <tbody id="tbodyTest"></tbody>
  </table>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
  crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="https://cdn.jsdelivr.net/npm/notiflix@3.2.6/dist/notiflix-aio-3.2.6.min.js"
  integrity="sha256-pXMqYvjzxYjuQ3+Iz0Zpw3Tk3BAoet8dOsODol/iqTI=" crossorigin="anonymous"></script>

  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>  

  <script>
    Notiflix.Notify.init({
      width: '280px',
      position: 'right-top',
      distance: '10px',
      opacity: 1,
      borderRadius: '5px',
      rtl: false,
      timeout: 3000,
      messageMaxLength: 110,
      backOverlay: false,
      backOverlayColor: 'rgba(0,0,0,0.5)',
      plainText: true,
      showOnlyTheLastOne: true,
      clickToClose: false,
      pauseOnHover: true,
      ID: 'NotiflixNotify',
      className: 'notiflix-notify',
      zindex: 4001,
      fontFamily: 'Quicksand',
      fontSize: '13px',
      cssAnimation: true,
      cssAnimationDuration: 400,
      cssAnimationStyle: 'fade',
      closeButton: false,
      useIcon: true,
      useFontAwesome: false,
      fontAwesomeIconStyle: 'basic',
      fontAwesomeIconSize: '34px',
      success: {
        background: '#32c682',
        textColor: '#fff',
        childClassName: 'notiflix-notify-success',
        notiflixIconColor: 'rgba(0,0,0,0.2)',
        fontAwesomeClassName: 'fas fa-check-circle',
        fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
        backOverlayColor: 'rgba(50,198,130,0.2)',
      },
      failure: {
        background: '#ff5549',
        textColor: '#fff',
        childClassName: 'notiflix-notify-failure',
        notiflixIconColor: 'rgba(0,0,0,0.2)',
        fontAwesomeClassName: 'fas fa-times-circle',
        fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
        backOverlayColor: 'rgba(255,85,73,0.2)',
      },
      warning: {
        background: '#eebf31',
        textColor: '#fff',
        childClassName: 'notiflix-notify-warning',
        notiflixIconColor: 'rgba(0,0,0,0.2)',
        fontAwesomeClassName: 'fas fa-exclamation-circle',
        fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
        backOverlayColor: 'rgba(238,191,49,0.2)',
      },
      info: {
        background: '#26c0d3',
        textColor: '#fff',
        childClassName: 'notiflix-notify-info',
        notiflixIconColor: 'rgba(0,0,0,0.2)',
        fontAwesomeClassName: 'fas fa-info-circle',
        fontAwesomeIconColor: 'rgba(0,0,0,0.2)',
        backOverlayColor: 'rgba(38,192,211,0.2)',
      },
    });

    function showMessage(msg){
        Toastify({
        text: msg,
        duration: 3000,
        destination: "https://github.com/apvarun/toastify-js",
        newWindow: true,
        close: true,
        gravity: "top", // `top` or `bottom`
        position: "center", // `left`, `center` or `right`
        stopOnFocus: true, // Prevents dismissing of toast on hover
        style: {
          background: "linear-gradient(to right, #00b09b, #96c93d)",
        },
        onClick: function(){} // Callback after click
      }).showToast();
};


    var editId = "";

    loadTable();

    $("#btnSave").click(function (e) {
        e.preventDefault();
      var title = $("#txtTitle").val();
      var author=$("#txtAuthor").val();
      var content=$("#txtContent").val();

      var genre = []; 
    $("input[name='txtGenre']:checked").each(function () {
    genre.push($(this).val());
  });
  genre = genre.join(",");

  var status = $("input[name='txtStatus']:checked").val();

if (title === null || title === undefined || title === "") {
  validateMsg("Please enter title.");
  return;
}

if (author === null || author === undefined || author === "") {
  validateMsg("Please enter author.");
  return;
}

if (content === null || content === undefined || content === "") {
  validateMsg("Please enter content.");
  return;
}

if(genre.length < 0){
validateMsg("Please select at least one genre.");
  return;
}

Notiflix.Block.standard('#loading');


      var lst = getData();

      const testObj = {
        Id: uuidv4(),
        Title: title,
        Author:author,
        Content:content,
        Genre:genre,
        Status:status
      };

      lst.push(testObj);

      localStorage.setItem("Tbl_Blog", JSON.stringify(lst));

      $("#txtTitle").val("");
      $("#txtAuthor").val("");
      $("#txtContent").val("");
      $("input[name='txtGenre']").prop('checked', false);
     $("#published").prop('checked', true);
   
      $("#txtTitle").focus();

      setTimeout(() => {
        // Notiflix.Loading.remove(1000);
        Notiflix.Block.remove('#loading', 1923);
        showMessage("Saving Successful.");
        loadTable();
      }, 2000);

    });

    function loadTable() {
      $("#tbodyTest").empty();

      var lst = getData();

      $.each(lst, function (key, value) {
        console.log(key + ": " + value.Id + "," + value.Name);
        let htmlRow = `
<tr>
    <td>
        <button type="button" class="btn btn-warning" onclick="Edit(this)" data-id="${value.Id
          }">Edit</button>
        <button type="button" class="btn btn-danger" onclick="Delete(this)" data-id="${value.Id
          }">Delete</button>
        </td>
    <td>${key + 1}</td>
    <td>${value.Title}</td>
    <td>${value.Author}</td>
    <td>${value.Content}</td>
    <td>${value.Genre}</td>
    <td>${value.Status}</td>
</tr>
                `;
        $("#tbodyTest").append(htmlRow);
      });
    }

    function uuidv4() {
      return "10000000-1000-4000-8000-100000000000".replace(/[018]/g, (c) =>
        (
          c ^
          (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))
        ).toString(16)
      );
    }

    function Edit(ele) {
      let id = $(ele).data("id");

      var lst = getData();

      const result = lst.filter(function (x) {
        return x.Id == id;
      });

      var item = result[0];
      $("#txtTitle").val(item.Title);
      $("#txtAuthor").val(item.Author);
      $("#txtContent").val(item.Content);

      $("input[name='txtGenre']").prop('checked', false);
        var genres = item.Genre.split(',');
        genres.forEach(function(genre) {
        $("input[name='txtGenre'][value='" + genre + "']").prop('checked', true);
  });

  $("input[name='txtStatus']").prop('checked', false);
  $("input[name='txtStatus'][value='" + item.Status + "']").prop('checked', true);


      editId = item.Id;
    }

    $("#btnUpdate").click(function (e) {
      if (editId === "") return;

      var lst = getData();
      let index = lst.findIndex((x) => x.Id == editId);
      console.log(`index ${index}`);

      var editTitle=$("#txtTitle").val();
      var editAuthor=$("#txtAuthor").val();
      var editContent=$("#txtContent").val();
      var editGenre = []; 
      $("input[name='txtGenre']:checked").each(function () {
        editGenre.push($(this).val());
    });
    editGenre = editGenre.join(",");

    var editStatus = $("input[name='txtStatus']:checked").val();

    if (editTitle === null || editTitle === undefined || editTitle === "") {
  validateMsg("Please enter title.");
  return;
}

if (editAuthor === null || editAuthor === undefined || editAuthor === "") {
  validateMsg("Please enter author.");
  return;
}

if (editContent === null || editContent === undefined || editContent === "") {
  validateMsg("Please enter content.");
  return;
}

if(editGenre.length < 0){
validateMsg("Please select at least one genre.");
  return;
}

Notiflix.Block.standard('#loading');

  

      lst[index].Title = editTitle;
      lst[index].Author = editAuthor;
      lst[index].Content = editContent;
      lst[index].Genre = editGenre;
      lst[index].Status = editStatus;

      editId = "";
      setLocal(lst);

      $("#txtTitle").val("");
      $("#txtAuthor").val("");
      $("#txtContent").val("");
      $("input[name='txtGenre']").prop('checked', false);
     $("#published").prop('checked', true);
     
     
     setTimeout(() => {
        // Notiflix.Loading.remove(1000);
        Notiflix.Block.remove('#loading', 1923);
        showMessage("Update Successful!")
        loadTable();
      }, 2000);

    });

    function Delete(ele) {
        confirmMsg("Are you sure want to delete?").then((result) => {
        console.log(result);
        if (!result) return;

        Notiflix.Block.standard('#loading');
        let id = $(ele).data("id");
        var lst = getData();
        let index = lst.findIndex((x) => x.Id == id);
        lst.splice(index, 1);

        setLocal(lst);
        setTimeout(() => {
        // Notiflix.Loading.remove(1000);
        Notiflix.Block.remove('#loading', 1300);
        showMessage("Deleting Successful!")
        loadTable();
      }, 2000);
      });
    }

    function getData() {
      var lst = [];
      var jsonStr = localStorage.getItem("Tbl_Blog");
      if (!(jsonStr === undefined || jsonStr === null || jsonStr === "")) {
        lst = JSON.parse(jsonStr);
      }
      return lst;
    }

    function setLocal(lst) {
      localStorage.setItem("Tbl_Blog", JSON.stringify(lst));
    }

    function successMsg(message) {
      Notiflix.Notify.success(message);
    }

    function validateMsg(message) {

      Notiflix.Notify.warning(message);
    }

    function confirmMsg(message) {

      return new Promise(function (resolve, reject) {
        Notiflix.Confirm.show(
          "Confirm",
          message,
          "Yes",
          "No",
          function okCb() {
            resolve(true);
          },
          function cancelCb() {
            resolve(false);
          },
          {}
        );
      });
    }
  </script>
</body>

</html>




























